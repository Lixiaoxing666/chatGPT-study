User
Mongodbè¡¨ä¸è¡¨ä¹‹é—´æœ‰æ²¡æœ‰ä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤šå…³ç³»ï¼Œå¦‚æœæœ‰ï¼Œmongodbæ€ä¹ˆå»ç»´æŠ¤è¿™ç§å…³ç³»ï¼Ÿ
GPT
MongoDBï¼Œä½œä¸ºä¸€ä¸ªéå…³ç³»å‹æ•°æ®åº“ï¼Œæœ¬è´¨ä¸Šå¹¶ä¸ç›´æ¥æ”¯æŒåƒå…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ä¹‹é—´çš„ä¸€å¯¹å¤šæˆ–å¤šå¯¹å¤šå…³ç³»ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾è®¡æ–‡æ¡£ç»“æ„å’Œä½¿ç”¨æŸ¥è¯¢æŠ€æœ¯æ¥æ¨¡æ‹Ÿè¿™äº›å…³ç³»ã€‚

ä¸€å¯¹å¤šå…³ç³»
åœ¨MongoDBä¸­ï¼Œä¸€å¯¹å¤šå…³ç³»é€šå¸¸é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°ï¼š

åµŒå…¥æ–‡æ¡£ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œé€‚ç”¨äºä¸€å¯¹å¤šå…³ç³»ä¸­â€œå¤šâ€çš„éƒ¨åˆ†ä¸ä¼šè¿‡äºåºå¤§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­æ–‡æ¡£ä¼šç›´æ¥åµŒå…¥åˆ°çˆ¶æ–‡æ¡£ä¸­ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·æ–‡æ¡£å¯èƒ½ç›´æ¥åŒ…å«å¤šä¸ªåœ°å€æ–‡æ¡£ã€‚

å¼•ç”¨ï¼šå½“â€œå¤šâ€çš„ä¸€æ–¹æ–‡æ¡£æ•°é‡è¾ƒå¤§æˆ–è€…éœ€è¦ç‹¬ç«‹ç»´æŠ¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¼•ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åœ¨å­æ–‡æ¡£ä¸­å­˜å‚¨çˆ¶æ–‡æ¡£çš„IDä½œä¸ºå¼•ç”¨ã€‚è¿™ç§æ–¹æ³•éœ€è¦é¢å¤–çš„æŸ¥è¯¢æ¥è§£æå¼•ç”¨ã€‚

å¤šå¯¹å¤šå…³ç³»
å¤šå¯¹å¤šå…³ç³»å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•å®ç°ï¼š

åŒå‘å¼•ç”¨ï¼šåœ¨æ¯ä¸ªç›¸å…³æ–‡æ¡£ä¸­å­˜å‚¨å¦ä¸€æ–¹æ–‡æ¡£çš„IDåˆ—è¡¨ã€‚è¿™ç§æ–¹æ³•åœ¨æ•°æ®æ›´æ–°æ—¶éœ€è¦ç»´æŠ¤ä¸¤è¾¹çš„å¼•ç”¨ï¼Œå¯èƒ½æ¯”è¾ƒç¹çã€‚

å…³è”é›†åˆï¼šåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„é›†åˆæ¥å­˜å‚¨å…³è”ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰â€œå­¦ç”Ÿâ€å’Œâ€œè¯¾ç¨‹â€ä¸¤ä¸ªé›†åˆï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç¬¬ä¸‰ä¸ªé›†åˆï¼Œå¦‚â€œå­¦ç”Ÿè¯¾ç¨‹â€ï¼Œæ¥å­˜å‚¨å­¦ç”ŸIDå’Œè¯¾ç¨‹IDçš„ç»„åˆã€‚

ç»´æŠ¤å…³ç³»
å…³äºå¦‚ä½•ç»´æŠ¤è¿™äº›å…³ç³»ï¼š

ä¸€è‡´æ€§ï¼šMongoDBä¸æä¾›åƒSQLæ•°æ®åº“é‚£æ ·çš„äº‹åŠ¡æ”¯æŒï¼ˆå°½ç®¡æœ€æ–°ç‰ˆæœ¬çš„MongoDBå·²ç»åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ”¯æŒäº‹åŠ¡ï¼‰ï¼Œå› æ­¤åœ¨æ›´æ–°æ¶‰åŠå¤šä¸ªæ–‡æ¡£çš„æ•°æ®æ—¶éœ€è¦æ ¼å¤–å°å¿ƒã€‚

æ€§èƒ½è€ƒé‡ï¼šåµŒå…¥æ–‡æ¡£å¯ä»¥æä¾›æ›´å¿«çš„è¯»å–é€Ÿåº¦ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ–‡æ¡£å˜å¾—è¿‡å¤§ã€‚å¼•ç”¨æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œä½†éœ€è¦é¢å¤–çš„æŸ¥è¯¢æ¥è·å–å®Œæ•´æ•°æ®ã€‚

æ•°æ®æ¨¡å‹è®¾è®¡ï¼šé€‰æ‹©å“ªç§æ–¹å¼å–å†³äºä½ çš„å…·ä½“åº”ç”¨åœºæ™¯ã€‚è€ƒè™‘åˆ°è¯»å†™é¢‘ç‡ã€æ•°æ®å¤§å°å’Œæ•°æ®ç»“æ„çš„å˜åŒ–ç­‰å› ç´ ã€‚

MongoDBçš„çµæ´»æ€§åœ¨äºå®ƒå…è®¸ä½ æ ¹æ®åº”ç”¨éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„æ•°æ®æ¨¡å‹ã€‚ä½†è¿™ä¹Ÿæ„å‘³ç€åœ¨è®¾è®¡é˜¶æ®µéœ€è¦æ›´å¤šçš„è€ƒè™‘å’Œè®¡åˆ’ã€‚ ğŸ˜Š

User
å½“å­˜åœ¨ä¸€å¯¹å¤šå…³ç³»æ—¶ï¼Œå¦‚æœæˆ‘ä»¬é‡‡ç”¨äº†å¼•ç”¨ï¼Œå³åœ¨å­æ–‡æ¡£ä¸­å­˜å‚¨çˆ¶æ–‡æ¡£çš„IDä½œä¸ºå¼•ç”¨ï¼Œmongooseåœ¨å»ºæ¨¡æ—¶å¦‚ä½•è®¾è®¡ï¼Œå½“éœ€è¦å¢æŸ¥åˆ æ”¹æ•°æ®æ—¶ï¼Œmongooseè¯­å¥åº”è¯¥å¦‚ä½•å†™ï¼Ÿ
GPT
å½“åœ¨Mongooseä¸­å¤„ç†ä¸€å¯¹å¤šå…³ç³»ï¼Œå¹¶ä¸”é€‰æ‹©ä½¿ç”¨å¼•ç”¨ï¼ˆå³åœ¨å­æ–‡æ¡£ä¸­å­˜å‚¨çˆ¶æ–‡æ¡£çš„IDï¼‰ï¼Œä½ éœ€è¦åœ¨æ¨¡å‹è®¾è®¡æ—¶æŒ‡å®šè¿™ç§å…³ç³»ã€‚ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸€è¿‡ç¨‹ã€‚

ä¾‹å­ï¼šç”¨æˆ·å’Œå¸–å­çš„å…³ç³»
å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ¨¡å‹ï¼šUser å’Œ Postã€‚ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªå¸–å­ï¼Œè¿™å½¢æˆäº†ä¸€å¯¹å¤šçš„å…³ç³»ã€‚

æ¨¡å‹è®¾è®¡
User Modelï¼ˆçˆ¶æ–‡æ¡£ï¼‰

javascript
Copy code
const mongoose = require('mongoose');
const { Schema } = mongoose;

const userSchema = new Schema({
    name: String,
    // å…¶ä»–ç”¨æˆ·å­—æ®µ
});

const User = mongoose.model('User', userSchema);
Post Modelï¼ˆå­æ–‡æ¡£ï¼ŒåŒ…å«å¯¹Userçš„å¼•ç”¨ï¼‰

javascript
Copy code
const postSchema = new Schema({
    title: String,
    content: String,
    author: {
        type: Schema.Types.ObjectId,
        ref: 'User'
    }
});

const Post = mongoose.model('Post', postSchema);
åˆ›å»ºæ•°æ®ï¼ˆå¢ï¼‰
å½“ä½ åˆ›å»ºä¸€ä¸ªå¸–å­æ—¶ï¼Œä½ éœ€è¦å°†authorå­—æ®µè®¾ç½®ä¸ºå¯¹åº”ç”¨æˆ·çš„IDã€‚

javascript
Copy code
const newPost = new Post({
    title: 'My First Post',
    content: 'This is the content of my first post.',
    author: someUserId // è¿™é‡Œæ˜¯åˆ›å»ºç”¨æˆ·æ—¶è·å¾—çš„ç”¨æˆ·ID
});

newPost.save();
æŸ¥è¯¢æ•°æ®ï¼ˆæŸ¥ï¼‰
è¦æŸ¥è¯¢å¸–å­å¹¶å¸¦ä¸Šç”¨æˆ·ä¿¡æ¯ï¼Œä½ å¯ä»¥ä½¿ç”¨.populate()æ–¹æ³•ã€‚

javascript
Copy code
Post.find({}).populate('author').exec((err, posts) => {
    if (err) throw err;
    console.log(posts);
});
æ›´æ–°æ•°æ®ï¼ˆæ”¹ï¼‰
æ›´æ–°ä¸€ä¸ªå¸–å­æ—¶ï¼Œå¦‚æœä½ éœ€è¦æ›´æ”¹å¸–å­çš„ä½œè€…ï¼Œå¯ä»¥åƒæ›´æ–°å…¶ä»–å­—æ®µä¸€æ ·è¿›è¡Œã€‚

javascript
Copy code
Post.findByIdAndUpdate(postId, { author: newUserId }, (err, post) => {
    if (err) throw err;
    // åšäº›ä»€ä¹ˆï¼Œæ¯”å¦‚è¿”å›æ›´æ–°åçš„å¸–å­
});
åˆ é™¤æ•°æ®ï¼ˆåˆ ï¼‰
åˆ é™¤å¸–å­æ˜¯ç›´æ¥çš„ï¼Œä½†å¦‚æœä½ éœ€è¦åœ¨åˆ é™¤ç”¨æˆ·æ—¶åŒæ—¶åˆ é™¤è¯¥ç”¨æˆ·çš„æ‰€æœ‰å¸–å­ï¼Œéœ€è¦é¢å¤–çš„æ­¥éª¤ã€‚

javascript
Copy code
// åˆ é™¤å¸–å­
Post.findByIdAndRemove(postId, (err) => {
    if (err) throw err;
    // å¸–å­å·²è¢«åˆ é™¤
});

// å¦‚æœéœ€è¦ï¼Œåˆ é™¤ç”¨æˆ·å’Œå…¶æ‰€æœ‰å¸–å­
User.findByIdAndRemove(userId, (err) => {
    if (err) throw err;
    Post.deleteMany({ author: userId }, (err) => {
        if (err) throw err;
        // ç”¨æˆ·å’Œæ‰€æœ‰å¸–å­éƒ½å·²è¢«åˆ é™¤
    });
});
è¿™ç§æ–¹å¼ä½¿å¾—æ•°æ®ç»“æ„æ›´åŠ çµæ´»ï¼Œä½†æ˜¯ä¹Ÿè¦æ³¨æ„ï¼Œç”±äºMongoDBæœ¬èº«ä¸æ”¯æŒè·¨æ–‡æ¡£çš„äº‹åŠ¡å¤„ç†ï¼ˆå°½ç®¡æœ€æ–°ç‰ˆæœ¬æœ‰æ‰€æ”¯æŒï¼‰ï¼Œåœ¨å¤„ç†è¿™ç§å…³ç³»æ—¶å¯èƒ½éœ€è¦é¢å¤–è€ƒè™‘æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚

==========================================================================
User
å‡è®¾ç°åœ¨æœ‰å­¦ç”Ÿè¡¨å’Œè¯¾ç¨‹è¡¨å¤šå¯¹å¤šå…³ç³»ï¼Œé‡‡ç”¨åŒå‘å¼•ç”¨çš„æ–¹å¼ï¼Œåœ¨nest.jsä¸­Mongooseæ¨¡å‹åº”è¯¥å¦‚ä½•è®¾è®¡ï¼Œæ¶‰åŠå¢æŸ¥åˆ æ”¹ï¼Œ åˆ é™¤å¤šæ¡åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£ï¼Œæ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£ï¼Œåˆ†é¡µæŸ¥è¯¢ï¼Œå¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢çš„æŸ¥è¯¢è¯­å¥åº”è¯¥å¦‚ä½•å†™ï¼Œè¯·è¯¦ç»†å†™å‡ºå„è¯­å¥ï¼Œä¸è¦çœç•¥ã€‚
GPT
åœ¨Nest.jsä¸­ä½¿ç”¨Mongooseæ¥å¤„ç†å­¦ç”Ÿå’Œè¯¾ç¨‹çš„å¤šå¯¹å¤šå…³ç³»æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨åŒå‘å¼•ç”¨çš„æ–¹æ³•ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥è®¾è®¡å­¦ç”Ÿï¼ˆStudentï¼‰å’Œè¯¾ç¨‹ï¼ˆCourseï¼‰çš„æ¨¡å‹ï¼Œç„¶åæˆ‘å°†è¯¦ç»†è¯´æ˜å¢åˆ æŸ¥æ”¹ç­‰æ“ä½œçš„å®ç°æ–¹æ³•ã€‚

æ¨¡å‹è®¾è®¡
Student Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const StudentSchema = new mongoose.Schema({
    name: String,
    courses: [
        {
            type: mongoose.Schema.Types.ObjectId,
            ref: 'Course'
        }
    ],
    // å…¶ä»–å­—æ®µ
});
Course Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const CourseSchema = new mongoose.Schema({
    title: String,
    students: [
        {
            type: mongoose.Schema.Types.ObjectId,
            ref: 'Student'
        }
    ],
    // å…¶ä»–å­—æ®µ
});
å¢åŠ æ•°æ®ï¼ˆå¢ï¼‰
æ·»åŠ æ–°å­¦ç”Ÿ
typescript
Copy code
const newStudent = new this.studentModel({
    name: 'John Doe',
    courses: [] // åˆå§‹ä¸ºç©ºï¼Œç¨åæ·»åŠ è¯¾ç¨‹
});
await newStudent.save();
æ·»åŠ æ–°è¯¾ç¨‹
typescript
Copy code
const newCourse = new this.courseModel({
    title: 'Mathematics',
    students: [] // åˆå§‹ä¸ºç©ºï¼Œç¨åæ·»åŠ å­¦ç”Ÿ
});
await newCourse.save();
æŸ¥è¯¢æ•°æ®ï¼ˆæŸ¥ï¼‰
æŸ¥æ‰¾æ‰€æœ‰å­¦ç”Ÿ
typescript
Copy code
const students = await this.studentModel.find().exec();
åˆ†é¡µæŸ¥è¯¢è¯¾ç¨‹
typescript
Copy code
const page = 1;
const limit = 10;
const courses = await this.courseModel.find()
    .skip((page - 1) * limit)
    .limit(limit)
    .exec();
å¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢å­¦ç”Ÿ
typescript
Copy code
const searchCondition = { name: 'John Doe' }; // ä½œä¸ºä¾‹å­
const students = await this.studentModel.find(searchCondition)
    .skip((page - 1) * limit)
    .limit(limit)
    .exec();
æ›´æ–°æ•°æ®ï¼ˆæ”¹ï¼‰
æ›´æ–°å­¦ç”Ÿä¿¡æ¯
typescript
Copy code
const updatedStudent = await this.studentModel.findByIdAndUpdate(
    studentId,
    { name: 'Jane Doe' },
    { new: true } // è¿”å›æ›´æ–°åçš„æ–‡æ¡£
).exec();
æ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
const updateResult = await this.courseModel.updateMany(
    { title: /math/i }, // åŒ¹é…æ‰€æœ‰åŒ…å«â€œmathâ€çš„è¯¾ç¨‹
    { title: 'Advanced Mathematics' }
).exec();
åˆ é™¤æ•°æ®ï¼ˆåˆ ï¼‰
åˆ é™¤å­¦ç”Ÿ
typescript
Copy code
const deleteResult = await this.studentModel.findByIdAndRemove(studentId).exec();
åˆ é™¤å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
const deleteResult = await this.courseModel.deleteMany({ title: /math/i }).exec();
åŒå‘å¼•ç”¨çš„ç®¡ç†
å½“æ·»åŠ å­¦ç”Ÿåˆ°è¯¾ç¨‹æ—¶ï¼ˆæˆ–ç›¸åï¼‰ï¼Œä½ éœ€è¦æ›´æ–°ä¸¤ä¸ªæ¨¡å‹ã€‚

æŠŠå­¦ç”Ÿæ·»åŠ åˆ°è¯¾ç¨‹
typescript
Copy code
// å‡è®¾å·²æœ‰studentIdå’ŒcourseId
await this.courseModel.findByIdAndUpdate(
    courseId,
    { $addToSet: { students: studentId } } // é¿å…é‡å¤æ·»åŠ 
).exec();

await this.studentModel.findByIdAndUpdate(
    studentId,
    { $addToSet: { courses: courseId } } // é¿å…é‡å¤æ·»åŠ 
).exec();
ä»è¯¾ç¨‹ä¸­ç§»é™¤å­¦ç”Ÿ
typescript
Copy code
await this.courseModel.findByIdAndUpdate(
    courseId,
    { $pull: { students: studentId } }
).exec();

await this.studentModel.findByIdAndUpdate(
    studentId,
    { $pull: { courses: courseId } }
).exec();
åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½è¿˜éœ€è¦å¤„ç†é”™è¯¯å’Œå¼‚å¸¸æƒ…å†µï¼Œä»¥åŠå¯èƒ½çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚åŒå‘å¼•ç”¨éœ€è¦ä½ åœ¨æ›´æ–°å…³ç³»æ—¶æ³¨æ„ä¸¤è¾¹çš„æ•°æ®åŒæ­¥ã€‚

User
å‡ ä¸ªç–‘é—®ï¼š1.{ title: /math/i }, // åŒ¹é…æ‰€æœ‰åŒ…å«â€œmathâ€çš„è¯¾ç¨‹ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·å†™/math/i ï¼Œä»€ä¹ˆå«ä¹‰ï¼Ÿ2 åˆ é™¤ä¸€ä¸ªåˆ°åº•æœ‰å‡ ä¸ªapiï¼ŒfindByIdAndRemoveï¼ŒfindOneAndDeleteï¼ŒdeleteOneéƒ½æ˜¯åˆ é™¤ä¸€æ¡ï¼Œä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿåˆ°åº•åº”è¯¥ç”¨å“ªä¸ªï¼Ÿ
GPT
è¿™æ˜¯ä¸¤ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼Œè®©æˆ‘é€ä¸€è§£ç­”ï¼š

1. æ­£åˆ™è¡¨è¾¾å¼ { title: /math/i } çš„å«ä¹‰
åœ¨MongoDBä¸­ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ˆRegExpï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„æ–¹æ³•æ¥è¿›è¡Œæ¨¡å¼åŒ¹é…æŸ¥è¯¢ã€‚åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œ{ title: /math/i } ç”¨äºæŸ¥æ‰¾æ ‡é¢˜ä¸­åŒ…å«â€œmathâ€çš„è¯¾ç¨‹ã€‚

/math/ï¼šè¿™éƒ¨åˆ†æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„ä¸»ä½“ï¼Œç”¨æ¥æŒ‡å®šä½ æƒ³åŒ¹é…çš„æ¨¡å¼ã€‚è¿™é‡Œå®ƒè¡¨ç¤ºåŒ¹é…ä»»ä½•åŒ…å«â€œmathâ€å­—ç¬¦ä¸²çš„åœ°æ–¹ã€‚
iï¼šè¿™æ˜¯ä¸€ä¸ªâ€œæ ‡å¿—â€ï¼ˆflagï¼‰ï¼Œç”¨äºä¿®æ”¹æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ã€‚iè¡¨ç¤ºâ€œä¸åŒºåˆ†å¤§å°å†™â€ï¼ˆinsensitiveï¼‰ï¼Œè¿™æ„å‘³ç€æ— è®ºæ˜¯â€œMathâ€ï¼Œâ€œMATHâ€ï¼Œè¿˜æ˜¯â€œmathâ€ï¼Œéƒ½ä¼šè¢«åŒ¹é…ã€‚
æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºæ‰§è¡Œå¤æ‚çš„æ–‡æœ¬æ¨¡å¼åŒ¹é…å’ŒæŸ¥æ‰¾/æ›¿æ¢æ“ä½œã€‚

2. åˆ é™¤æ–‡æ¡£çš„ä¸åŒAPIåŠå…¶åŒºåˆ«
MongoDBå’ŒMongooseæä¾›äº†å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥åˆ é™¤æ–‡æ¡£ï¼Œå®ƒä»¬åœ¨æŸäº›æ–¹é¢æœ‰æ‰€ä¸åŒï¼š

Model.findByIdAndRemove(id, [options], [callback]): æ ¹æ®æ–‡æ¡£çš„IDæ¥åˆ é™¤æ–‡æ¡£ã€‚å®ƒæ˜¯Model.findOneAndRemove({ _id: id }, [options], [callback])çš„ä¾¿æ·æ–¹å¼ã€‚å¦‚æœä½ å·²ç»æœ‰äº†æ–‡æ¡£çš„IDï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„é€‰æ‹©ã€‚

Model.findOneAndDelete(conditions, [options], [callback]): æ ¹æ®æŒ‡å®šçš„æ¡ä»¶æŸ¥æ‰¾å•ä¸ªæ–‡æ¡£å¹¶åˆ é™¤ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯æ¯”è¾ƒæ–°çš„ï¼Œå’ŒfindOneAndRemoveç±»ä¼¼ï¼Œä½†å®ƒç¬¦åˆæ›´ç°ä»£çš„MongoDBåˆ é™¤æ“ä½œçš„è¡Œä¸ºã€‚

Model.deleteOne(conditions, [callback]): æ ¹æ®æŒ‡å®šçš„æ¡ä»¶åˆ é™¤å•ä¸ªæ–‡æ¡£ã€‚è¿™ä¸ªæ–¹æ³•ä¸è¿”å›è¢«åˆ é™¤çš„æ–‡æ¡£ã€‚

//todo åŒºåˆ«ä¸»è¦åœ¨äºï¼š

findByIdAndRemove å’Œ findOneAndDelete åœ¨åˆ é™¤æ–‡æ¡£ä¹‹å‰ä¼šè¿”å›è¿™ä¸ªæ–‡æ¡£ï¼Œè€Œ deleteOne ä¸ä¼šã€‚
findByIdAndRemove æ˜¯åŸºäºIDæŸ¥æ‰¾å¹¶åˆ é™¤ï¼Œè€Œ findOneAndDelete å’Œ deleteOne æ˜¯åŸºäºæ¡ä»¶æŸ¥æ‰¾å¹¶åˆ é™¤ã€‚
findOneAndDelete æ˜¯æ¯” findOneAndRemove æ›´æ–°çš„æ–¹æ³•ï¼Œå¯èƒ½åœ¨æŸäº›æ–¹é¢ï¼ˆå¦‚æ€§èƒ½æˆ–æœ€æ–°MongoDBåŠŸèƒ½çš„æ”¯æŒï¼‰æœ‰ä¼˜åŠ¿ã€‚
é€‰æ‹©å“ªä¸€ä¸ªï¼Ÿ

å¦‚æœä½ å·²ç»çŸ¥é“æ–‡æ¡£çš„IDå¹¶ä¸”æƒ³åœ¨åˆ é™¤ä¹‹å‰è·å–è¿™ä¸ªæ–‡æ¡£ï¼Œä½¿ç”¨ findByIdAndRemoveã€‚
å¦‚æœä½ éœ€è¦æ ¹æ®ç‰¹å®šæ¡ä»¶åˆ é™¤æ–‡æ¡£ï¼Œå¹¶ä¸”æƒ³åœ¨åˆ é™¤ä¹‹å‰è·å–è¿™ä¸ªæ–‡æ¡£ï¼Œä½¿ç”¨ findOneAndDeleteã€‚
å¦‚æœåªéœ€ç®€å•åœ°æ ¹æ®æ¡ä»¶åˆ é™¤ä¸€ä¸ªæ–‡æ¡£ï¼Œå¹¶ä¸”ä¸éœ€è¦åœ¨åˆ é™¤ä¹‹å‰è·å–è¿™ä¸ªæ–‡æ¡£ï¼Œä½¿ç”¨ deleteOneã€‚
é€‰æ‹©å“ªä¸ªAPIå–å†³äºä½ çš„å…·ä½“éœ€æ±‚ï¼Œä¾‹å¦‚æ˜¯å¦éœ€è¦è®¿é—®è¢«åˆ é™¤çš„æ–‡æ¡£ï¼Œæˆ–è€…ä½ æ˜¯åŸºäºIDè¿˜æ˜¯æŸä¸ªæ¡ä»¶æ¥åˆ é™¤æ–‡æ¡£ã€‚

=========================================================================
    User
åŒå‘å¼•ç”¨çš„ç®¡ç†
å½“æ·»åŠ å­¦ç”Ÿåˆ°è¯¾ç¨‹æ—¶ï¼ˆæˆ–ç›¸åï¼‰ï¼Œä½ éœ€è¦æ›´æ–°ä¸¤ä¸ªæ¨¡å‹ã€‚

æŠŠå­¦ç”Ÿæ·»åŠ åˆ°è¯¾ç¨‹
typescript
Copy code
// å‡è®¾å·²æœ‰studentIdå’ŒcourseId
await this.courseModel.findByIdAndUpdate(
    courseId,
    { $addToSet: { students: studentId } } // é¿å…é‡å¤æ·»åŠ 
).exec();

await this.studentModel.findByIdAndUpdate(
    studentId,
    { $addToSet: { courses: courseId } } // é¿å…é‡å¤æ·»åŠ 
).exec();
ä»è¯¾ç¨‹ä¸­ç§»é™¤å­¦ç”Ÿ
typescript
Copy code
await this.courseModel.findByIdAndUpdate(
    courseId,
    { $pull: { students: studentId } }
).exec();

await this.studentModel.findByIdAndUpdate(
    studentId,
    { $pull: { courses: courseId } }
).exec();
ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ $addToSetå’Œ $pull æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä¸ºä»€ä¹ˆè¯´  { $addToSet: { students: studentId } } // è¯´å¯ä»¥é¿å…é‡å¤æ·»åŠ 
GPT
åœ¨MongoDBä¸­ï¼Œ$addToSet å’Œ $pull æ˜¯ä¸¤ä¸ªéå¸¸æœ‰ç”¨çš„æ•°ç»„æ›´æ–°æ“ä½œç¬¦ã€‚å®ƒä»¬åœ¨å¤„ç†æ•°ç»„ç±»å‹çš„å­—æ®µæ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œæ­£å¦‚åœ¨åŒå‘å¼•ç”¨çš„å­¦ç”Ÿå’Œè¯¾ç¨‹æ¨¡å‹ä¸­æ‰€è§ã€‚

$addToSet
ä½œç”¨ï¼š$addToSetæ“ä½œç¬¦ç”¨äºå‘æ•°ç»„å­—æ®µä¸­æ·»åŠ ä¸€ä¸ªå€¼ï¼Œä½†å‰ææ˜¯è¿™ä¸ªå€¼åœ¨æ•°ç»„ä¸­å°šä¸å­˜åœ¨ã€‚å¦‚æœå€¼å·²ç»å­˜åœ¨ï¼Œå®ƒä¸ä¼šè¢«é‡å¤æ·»åŠ ã€‚
ä¸ºä»€ä¹ˆå¯ä»¥é¿å…é‡å¤æ·»åŠ ï¼šå½“ä½ ä½¿ç”¨{ $addToSet: { students: studentId } }æ—¶ï¼ŒMongoDBä¼šæ£€æŸ¥studentsæ•°ç»„ä¸­æ˜¯å¦å·²ç»å­˜åœ¨studentIdã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå®ƒå°†studentIdæ·»åŠ åˆ°æ•°ç»„ä¸­ã€‚å¦‚æœstudentIdå·²ç»å­˜åœ¨äºæ•°ç»„ä¸­ï¼ŒMongoDBå°†ä¸åšä»»ä½•æ”¹å˜ã€‚è¿™å°±ç¡®ä¿äº†æ•°ç»„ä¸­çš„å€¼æ˜¯å”¯ä¸€çš„ï¼Œé¿å…äº†é‡å¤æ·»åŠ ã€‚
$pull
ä½œç”¨ï¼š$pullæ“ä½œç¬¦ç”¨äºä»æ•°ç»„å­—æ®µä¸­ç§»é™¤æ‰€æœ‰ä¸æŒ‡å®šæ¡ä»¶åŒ¹é…çš„å€¼ã€‚è¿™ä¸ªæ“ä½œç¬¦å¯¹äºåˆ é™¤æ•°ç»„ä¸­çš„ç‰¹å®šå…ƒç´ éå¸¸æœ‰æ•ˆã€‚
ç¤ºä¾‹ï¼šä½¿ç”¨{ $pull: { students: studentId } }æ—¶ï¼ŒMongoDBå°†æŸ¥æ‰¾studentsæ•°ç»„ä¸­æ‰€æœ‰ç­‰äºstudentIdçš„å…ƒç´ ï¼Œå¹¶å°†å®ƒä»¬å…¨éƒ¨ç§»é™¤ã€‚è¿™æ ·ï¼Œå³ä½¿studentIdåœ¨æ•°ç»„ä¸­å‡ºç°å¤šæ¬¡ï¼Œä¹Ÿä¼šè¢«å…¨éƒ¨åˆ é™¤ã€‚
è¿™äº›æ“ä½œç¬¦åœ¨å¤„ç†è¯¸å¦‚å…³ç³»ç»´æŠ¤è¿™æ ·çš„æ•°ç»„æ•°æ®æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥ç®€åŒ–ä»£ç å¹¶å‡å°‘å¯¹æ•°æ®ä¸€è‡´æ€§çš„æ‰‹åŠ¨ç®¡ç†éœ€æ±‚ã€‚åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨è¿™äº›æ“ä½œç¬¦æ¥ç®¡ç†å­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å…³ç³»å¯ä»¥ç¡®ä¿æ•°æ®çš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ï¼ŒåŒæ—¶ä¹Ÿä½¿å¾—ä»£ç æ›´åŠ ç®€æ´å’Œé«˜æ•ˆã€‚

User
é™¤äº†è¿™ä¸¤ä¸ªæ“ä½œç¬¦ï¼Œmongodbè¿˜æœ‰å“ªäº›æ“ä½œç¬¦ï¼Ÿ
GPT
MongoDBæä¾›äº†ä¸€ç³»åˆ—å¼ºå¤§çš„æ“ä½œç¬¦ï¼Œç”¨äºå¤„ç†å„ç§ç±»å‹çš„æ•°æ®æ“ä½œã€‚è¿™äº›æ“ä½œç¬¦å¯ä»¥åˆ†ä¸ºå‡ ä¸ªä¸»è¦ç±»åˆ«ï¼šæŸ¥è¯¢æ“ä½œç¬¦ã€æŠ•å½±æ“ä½œç¬¦ã€æ›´æ–°æ“ä½œç¬¦ã€æ•°ç»„æ“ä½œç¬¦ã€èšåˆæ“ä½œç¬¦ç­‰ã€‚ä¸‹é¢æ˜¯è¿™äº›ç±»åˆ«ä¸­ä¸€äº›å¸¸ç”¨æ“ä½œç¬¦çš„æ¦‚è§ˆï¼š

æŸ¥è¯¢æ“ä½œç¬¦
ç”¨äºæŸ¥è¯¢æ–‡æ¡£æ—¶æŒ‡å®šæ¡ä»¶ã€‚

$eq: ç­‰äº
$gt: å¤§äº
$gte: å¤§äºç­‰äº
$lt: å°äº
$lte: å°äºç­‰äº
$ne: ä¸ç­‰äº
$in: åœ¨æŒ‡å®šæ•°ç»„å†…
$nin: ä¸åœ¨æŒ‡å®šæ•°ç»„å†…
$or: é€»è¾‘æˆ–
$and: é€»è¾‘ä¸
$not: é€»è¾‘é
$nor: æ—¢ä¸...ä¹Ÿä¸...
$exists: å­—æ®µæ˜¯å¦å­˜åœ¨
$type: åŒ¹é…å­—æ®µçš„ç±»å‹
æŠ•å½±æ“ä½œç¬¦
ç”¨äºæŒ‡å®šè¿”å›å“ªäº›å­—æ®µã€‚

$: åŒ¹é…æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
$elemMatch: åŒ¹é…æ•°ç»„ä¸­çš„å…ƒç´ 
$slice: é€‰æ‹©æ•°ç»„çš„éƒ¨åˆ†
æ›´æ–°æ“ä½œç¬¦
ç”¨äºæ›´æ–°æ–‡æ¡£ä¸­çš„å­—æ®µå€¼ã€‚

$set: è®¾ç½®ä¸€ä¸ªå­—æ®µçš„å€¼
$unset: åˆ é™¤ä¸€ä¸ªå­—æ®µ
$inc: å¢åŠ ä¸€ä¸ªæ•°å€¼å­—æ®µçš„å€¼
$mul: ä¹˜æ³•
$rename: é‡å‘½åå­—æ®µ
$min: åªæœ‰å°äºå½“å‰å€¼æ—¶æ›´æ–°å­—æ®µ
$max: åªæœ‰å¤§äºå½“å‰å€¼æ—¶æ›´æ–°å­—æ®µ
$currentDate: è®¾ç½®å­—æ®µä¸ºå½“å‰æ—¥æœŸ
æ•°ç»„æ“ä½œç¬¦
ç”¨äºæ“ä½œæ•°ç»„ç±»å‹çš„å­—æ®µã€‚

$push: å‘æ•°ç»„æ·»åŠ ä¸€ä¸ªå…ƒç´ 
$pop: ç§»é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªå…ƒç´ 
$addToSet: å‘æ•°ç»„æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨
$pull: ä»æ•°ç»„ä¸­ç§»é™¤æŒ‡å®šçš„å…ƒç´ 
$pullAll: ä»æ•°ç»„ä¸­ç§»é™¤æ‰€æœ‰æŒ‡å®šçš„å€¼
$each: ä¸$pushæˆ–$addToSetä¸€èµ·ä½¿ç”¨ï¼Œæ·»åŠ å¤šä¸ªå…ƒç´ 
$position: ä¸$pushä¸€èµ·ä½¿ç”¨ï¼ŒæŒ‡å®šæ’å…¥æ•°ç»„çš„ä½ç½®
èšåˆæ“ä½œç¬¦
ç”¨äºèšåˆæ¡†æ¶ä¸­ï¼Œå¤„ç†æ•°æ®å¹¶è¿”å›è®¡ç®—ç»“æœã€‚

$group: å°†æ–‡æ¡£åˆ†ç»„
$match: è¿‡æ»¤æ•°æ®
$project: é€‰æ‹©æˆ–æ’é™¤å­—æ®µ
$sort: å¯¹æ•°æ®è¿›è¡Œæ’åº
$limit: é™åˆ¶èšåˆç®¡é“è¿”å›çš„æ–‡æ¡£æ•°é‡
$skip: è·³è¿‡æŒ‡å®šæ•°é‡çš„æ–‡æ¡£
$unwind: å±•å¼€æ•°ç»„å­—æ®µ
$sum: è®¡ç®—æ€»å’Œ
$avg: è®¡ç®—å¹³å‡å€¼
$min: è®¡ç®—æœ€å°å€¼
$max: è®¡ç®—æœ€å¤§å€¼
$count: è®¡ç®—æ–‡æ¡£çš„æ•°é‡
è¿™äº›æ“ä½œç¬¦æ˜¯MongoDBåŠŸèƒ½çš„æ ¸å¿ƒï¼Œä½¿å…¶å…·å¤‡å¤„ç†å¤æ‚æŸ¥è¯¢å’Œæ•°æ®æ“ä½œçš„èƒ½åŠ›ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šæ ¹æ®å…·ä½“éœ€æ±‚ç»„åˆä½¿ç”¨è¿™äº›æ“ä½œç¬¦æ¥å®ç°æ‰€éœ€çš„æ•°æ®æ“ä½œã€‚

======================================================================

    User
å‡è®¾ç°åœ¨æœ‰å­¦ç”Ÿè¡¨å’Œè¯¾ç¨‹è¡¨å¤šå¯¹å¤šå…³ç³»ï¼Œé‡‡ç”¨å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰çš„æ–¹å¼å…³è”ï¼Œåœ¨nest.jsä¸­Mongooseæ¨¡å‹åº”è¯¥å¦‚ä½•è®¾è®¡ï¼Œæ¶‰åŠå¢æŸ¥åˆ æ”¹ï¼Œ åˆ é™¤å¤šæ¡åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£ï¼Œæ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£ï¼Œåˆ†é¡µæŸ¥è¯¢ï¼Œå¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢çš„æŸ¥è¯¢è¯­å¥åº”è¯¥å¦‚ä½•å†™ï¼Œè¯·è¯¦ç»†å†™å‡ºå„è¯­å¥ï¼Œä¸è¦çœç•¥ã€‚
GPT
å½“ä½¿ç”¨å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰æ–¹æ³•æ¥å¤„ç†å­¦ç”Ÿï¼ˆStudentï¼‰å’Œè¯¾ç¨‹ï¼ˆCourseï¼‰ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»æ—¶ï¼Œä½ ä¼šéœ€è¦ä¸€ä¸ªé¢å¤–çš„é›†åˆæ¥å­˜å‚¨è¿™äº›å…³ç³»ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªåä¸ºEnrollmentçš„é›†åˆï¼Œå®ƒå°†å­˜å‚¨å­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å…³è”ã€‚ä¸‹é¢æˆ‘å°†å±•ç¤ºåœ¨Nest.jsä¸­ä½¿ç”¨Mongooseå¦‚ä½•è®¾è®¡è¿™äº›æ¨¡å‹ï¼Œä»¥åŠè¿›è¡Œå¢ã€åˆ ã€æŸ¥ã€æ”¹æ“ä½œçš„æ–¹æ³•ã€‚

æ¨¡å‹è®¾è®¡
Student Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const StudentSchema = new mongoose.Schema({
    name: String,
    // å…¶ä»–å­—æ®µ
});
Course Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const CourseSchema = new mongoose.Schema({
    title: String,
    // å…¶ä»–å­—æ®µ
});
Enrollment Modelï¼ˆå…³è”é›†åˆï¼‰
typescript
Copy code
import * as mongoose from 'mongoose';

export const EnrollmentSchema = new mongoose.Schema({
    student: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'Student'
    },
    course: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'Course'
    },
    // ä½ å¯ä»¥æ·»åŠ é¢å¤–çš„å­—æ®µï¼Œæ¯”å¦‚ enrollmentDate, status ç­‰
});
å¢åŠ æ•°æ®ï¼ˆå¢ï¼‰
æ·»åŠ æ–°å­¦ç”Ÿ
typescript
Copy code
const newStudent = new this.studentModel({ name: 'John Doe' });
await newStudent.save();
æ·»åŠ æ–°è¯¾ç¨‹
typescript
Copy code
const newCourse = new this.courseModel({ title: 'Mathematics' });
await newCourse.save();
å­¦ç”Ÿé€‰è¯¾ï¼ˆåˆ›å»ºæ–°çš„Enrollmentï¼‰
typescript
Copy code
const newEnrollment = new this.enrollmentModel({ student: studentId, course: courseId });
await newEnrollment.save();
æŸ¥è¯¢æ•°æ®ï¼ˆæŸ¥ï¼‰
æŸ¥æ‰¾æ‰€æœ‰å­¦ç”Ÿ
typescript
Copy code
const students = await this.studentModel.find().exec();
æŸ¥æ‰¾ç‰¹å®šå­¦ç”Ÿçš„æ‰€æœ‰è¯¾ç¨‹
typescript
Copy code
const studentCourses = await this.enrollmentModel.find({ student: studentId })
    .populate('course')
    .exec();
åˆ†é¡µæŸ¥è¯¢è¯¾ç¨‹
typescript
Copy code
const page = 1;
const limit = 10;
const courses = await this.courseModel.find()
    .skip((page - 1) * limit)
    .limit(limit)
    .exec();
å¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢å­¦ç”Ÿ
typescript
Copy code
const searchCondition = { name: 'John Doe' };
const students = await this.studentModel.find(searchCondition)
    .skip((page - 1) * limit)
    .limit(limit)
    .exec();
æ›´æ–°æ•°æ®ï¼ˆæ”¹ï¼‰
æ›´æ–°å­¦ç”Ÿä¿¡æ¯
typescript
Copy code
const updatedStudent = await this.studentModel.findByIdAndUpdate(
    studentId,
    { name: 'Jane Doe' },
    { new: true }
).exec();
æ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
const updateResult = await this.courseModel.updateMany(
    { title: /math/i },
    { title: 'Advanced Mathematics' }
).exec();
åˆ é™¤æ•°æ®ï¼ˆåˆ ï¼‰
åˆ é™¤å­¦ç”Ÿ
typescript
Copy code
const deleteResult = await this.studentModel.findByIdAndRemove(studentId).exec();
åˆ é™¤å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
const deleteResult = await this.courseModel.deleteMany({ title: /math/i }).exec();
åˆ é™¤å­¦ç”Ÿçš„ç‰¹å®šè¯¾ç¨‹ï¼ˆåˆ é™¤Enrollmentï¼‰
typescript
Copy code
const deleteEnrollment = await this.enrollmentModel.findOneAndDelete({ student: studentId, course: courseId }).exec();
æ³¨æ„äº‹é¡¹
ä½¿ç”¨å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰çš„æ–¹æ³•æ—¶ï¼Œå¯¹äºå­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å…³ç³»çš„å¢åŠ å’Œåˆ é™¤æ“ä½œä¸»è¦é›†ä¸­åœ¨Enrollmenté›†åˆä¸Šã€‚
åœ¨æ›´æ–°å’Œåˆ é™¤æ“ä½œä¸­ï¼Œç¡®ä¿è€ƒè™‘æ•°æ®ä¸€è‡´æ€§ã€‚ä¾‹å¦‚ï¼Œå½“åˆ é™¤ä¸€ä¸ªå­¦ç”Ÿæ—¶ï¼Œä½ å¯èƒ½ä¹Ÿéœ€è¦åˆ é™¤ä¸è¯¥å­¦ç”Ÿç›¸å…³çš„æ‰€æœ‰Enrollmentæ–‡æ¡£ã€‚
åˆ†é¡µæŸ¥è¯¢å’Œæ¡ä»¶æŸ¥è¯¢æ˜¯åŸºæœ¬çš„æ•°æ®åº“æ“ä½œï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´æŸ¥è¯¢æ¡ä»¶å’Œåˆ†é¡µå‚æ•°ã€‚User
å‡è®¾ç°åœ¨æœ‰å­¦ç”Ÿè¡¨å’Œè¯¾ç¨‹è¡¨å¤šå¯¹å¤šå…³ç³»ï¼Œé‡‡ç”¨å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰çš„æ–¹å¼å…³è”ï¼Œåœ¨nest.jsä¸­Mongooseæ¨¡å‹åº”è¯¥å¦‚ä½•è®¾è®¡ï¼Œæ¶‰åŠå¢æŸ¥åˆ æ”¹ï¼Œ åˆ é™¤å¤šæ¡åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£ï¼Œæ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£ï¼Œåˆ†é¡µæŸ¥è¯¢ï¼Œå¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢çš„æŸ¥è¯¢è¯­å¥åº”è¯¥å¦‚ä½•å†™ï¼Œè¯·è¯¦ç»†å†™å‡ºå„è¯­å¥ï¼Œä¸è¦çœç•¥ã€‚
GPT
å½“ä½¿ç”¨å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰æ–¹æ³•æ¥å¤„ç†å­¦ç”Ÿï¼ˆStudentï¼‰å’Œè¯¾ç¨‹ï¼ˆCourseï¼‰ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»æ—¶ï¼Œä½ ä¼šéœ€è¦ä¸€ä¸ªé¢å¤–çš„é›†åˆæ¥å­˜å‚¨è¿™äº›å…³ç³»ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªåä¸ºEnrollmentçš„é›†åˆï¼Œå®ƒå°†å­˜å‚¨å­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å…³è”ã€‚ä¸‹é¢æˆ‘å°†å±•ç¤ºåœ¨Nest.jsä¸­ä½¿ç”¨Mongooseå¦‚ä½•è®¾è®¡è¿™äº›æ¨¡å‹ï¼Œä»¥åŠè¿›è¡Œå¢ã€åˆ ã€æŸ¥ã€æ”¹æ“ä½œçš„æ–¹æ³•ã€‚

æ¨¡å‹è®¾è®¡
Student Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const StudentSchema = new mongoose.Schema({
    name: String,
    // å…¶ä»–å­—æ®µ
});
Course Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const CourseSchema = new mongoose.Schema({
    title: String,
    // å…¶ä»–å­—æ®µ
});
Enrollment Modelï¼ˆå…³è”é›†åˆï¼‰
typescript
Copy code
import * as mongoose from 'mongoose';

export const EnrollmentSchema = new mongoose.Schema({
    student: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'Student'
    },
    course: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'Course'
    },
    // ä½ å¯ä»¥æ·»åŠ é¢å¤–çš„å­—æ®µï¼Œæ¯”å¦‚ enrollmentDate, status ç­‰
});
å¢åŠ æ•°æ®ï¼ˆå¢ï¼‰
æ·»åŠ æ–°å­¦ç”Ÿ
typescript
Copy code
const newStudent = new this.studentModel({ name: 'John Doe' });
await newStudent.save();
æ·»åŠ æ–°è¯¾ç¨‹
typescript
Copy code
const newCourse = new this.courseModel({ title: 'Mathematics' });
await newCourse.save();
å­¦ç”Ÿé€‰è¯¾ï¼ˆåˆ›å»ºæ–°çš„Enrollmentï¼‰
typescript
Copy code
const newEnrollment = new this.enrollmentModel({ student: studentId, course: courseId });
await newEnrollment.save();
æŸ¥è¯¢æ•°æ®ï¼ˆæŸ¥ï¼‰
æŸ¥æ‰¾æ‰€æœ‰å­¦ç”Ÿ
typescript
Copy code
const students = await this.studentModel.find().exec();
æŸ¥æ‰¾ç‰¹å®šå­¦ç”Ÿçš„æ‰€æœ‰è¯¾ç¨‹
typescript
Copy code
const studentCourses = await this.enrollmentModel.find({ student: studentId })
    .populate('course')
    .exec();
åˆ†é¡µæŸ¥è¯¢è¯¾ç¨‹
typescript
Copy code
const page = 1;
const limit = 10;
const courses = await this.courseModel.find()
    .skip((page - 1) * limit)
    .limit(limit)
    .exec();
å¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢å­¦ç”Ÿ
typescript
Copy code
const searchCondition = { name: 'John Doe' };
const students = await this.studentModel.find(searchCondition)
    .skip((page - 1) * limit)
    .limit(limit)
    .exec();
æ›´æ–°æ•°æ®ï¼ˆæ”¹ï¼‰
æ›´æ–°å­¦ç”Ÿä¿¡æ¯
typescript
Copy code
const updatedStudent = await this.studentModel.findByIdAndUpdate(
    studentId,
    { name: 'Jane Doe' },
    { new: true }
).exec();
æ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
const updateResult = await this.courseModel.updateMany(
    { title: /math/i },
    { title: 'Advanced Mathematics' }
).exec();
åˆ é™¤æ•°æ®ï¼ˆåˆ ï¼‰
åˆ é™¤å­¦ç”Ÿ
typescript
Copy code
const deleteResult = await this.studentModel.findByIdAndRemove(studentId).exec();
åˆ é™¤å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
const deleteResult = await this.courseModel.deleteMany({ title: /math/i }).exec();
åˆ é™¤å­¦ç”Ÿçš„ç‰¹å®šè¯¾ç¨‹ï¼ˆåˆ é™¤Enrollmentï¼‰
typescript
Copy code
const deleteEnrollment = await this.enrollmentModel.findOneAndDelete({ student: studentId, course: courseId }).exec();
æ³¨æ„äº‹é¡¹
ä½¿ç”¨å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰çš„æ–¹æ³•æ—¶ï¼Œå¯¹äºå­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å…³ç³»çš„å¢åŠ å’Œåˆ é™¤æ“ä½œä¸»è¦é›†ä¸­åœ¨Enrollmenté›†åˆä¸Šã€‚
åœ¨æ›´æ–°å’Œåˆ é™¤æ“ä½œä¸­ï¼Œç¡®ä¿è€ƒè™‘æ•°æ®ä¸€è‡´æ€§ã€‚ä¾‹å¦‚ï¼Œå½“åˆ é™¤ä¸€ä¸ªå­¦ç”Ÿæ—¶ï¼Œä½ å¯èƒ½ä¹Ÿéœ€è¦åˆ é™¤ä¸è¯¥å­¦ç”Ÿç›¸å…³çš„æ‰€æœ‰Enrollmentæ–‡æ¡£ã€‚
åˆ†é¡µæŸ¥è¯¢å’Œæ¡ä»¶æŸ¥è¯¢æ˜¯åŸºæœ¬çš„æ•°æ®åº“æ“ä½œï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´æŸ¥è¯¢æ¡ä»¶å’Œåˆ†é¡µå‚æ•°ã€‚

============================================================================

    (ä»¥ä¸‹æ˜¯å¼•ç”¨ä¸­é—´è¡¨çš„æ–¹å¼)
    User
å­¦ç”Ÿå’Œè¯¾ç¨‹å¤šå¯¹å¤šä¹‹é—´çš„å¢æŸ¥åˆ æ”¹ï¼Œå¤šè¡¨è”æŸ¥ï¼Œåˆ†é¡µæŸ¥è¯¢ï¼Œå¸¦æ¡ä»¶åˆ†é¡µæŸ¥è¯¢éƒ½åº”è¯¥æ€ä¹ˆå†™ï¼Œè¯·å…·ä½“ä¸¾ä¾‹å†™å‡ºï¼Œå†™çš„è¯¦ç»†ä¸€ç‚¹ï¼Œä¸šåŠ¡ä»£ç å°½å¯èƒ½å¤æ‚ä¸€ç‚¹ï¼Œæ¨¡ä»¿çœŸå®å¼€å‘åœºæ™¯çš„ä»£ç 
GPT
ä¸ºäº†å¤„ç†ä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„çœŸå®å¼€å‘åœºæ™¯ä¸­çš„å­¦ç”Ÿå’Œè¯¾ç¨‹å¤šå¯¹å¤šå…³ç³»ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ›´å¤šç»†èŠ‚ï¼Œæ¯”å¦‚æ•°æ®éªŒè¯ã€é”™è¯¯å¤„ç†ã€å¤æ‚æŸ¥è¯¢ç­‰ã€‚ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªè¯¦ç»†çš„ä¾‹å­æ¥å±•ç¤ºå¦‚ä½•åœ¨Nest.jsä¸­ä½¿ç”¨Mongooseæ¥å®ç°è¿™äº›åŠŸèƒ½ã€‚

æ•°æ®æ¨¡å‹
é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸‰ä¸ªæ¨¡å‹ï¼šStudent, Course, å’Œ Enrollmentã€‚Enrollment ä½œä¸ºå…³è”é›†åˆï¼Œç”¨äºå­˜å‚¨å­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å…³ç³»ã€‚

Student Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const StudentSchema = new mongoose.Schema({
    name: { type: String, required: true },
    email: { type: String, required: true, unique: true },
    // å…¶ä»–å­—æ®µï¼Œå¦‚å¹´çº§ã€ä¸“ä¸šç­‰
});
Course Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const CourseSchema = new mongoose.Schema({
    title: { type: String, required: true },
    description: String,
    // å…¶ä»–å­—æ®µï¼Œå¦‚è¯¾ç¨‹ä»£ç ã€å­¦åˆ†ç­‰
});
Enrollment Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const EnrollmentSchema = new mongoose.Schema({
    student: { type: mongoose.Schema.Types.ObjectId, ref: 'Student', required: true },
    course: { type: mongoose.Schema.Types.ObjectId, ref: 'Course', required: true },
    enrolledDate: { type: Date, default: Date.now },
    // å…¶ä»–å­—æ®µï¼Œå¦‚æˆç»©ã€çŠ¶æ€ç­‰
});
å¢åŠ æ•°æ®ï¼ˆå¢ï¼‰
æ·»åŠ æ–°å­¦ç”Ÿ
typescript
Copy code
async addStudent(createStudentDto: CreateStudentDto): Promise<Student> {
    const createdStudent = new this.studentModel(createStudentDto);
    return await createdStudent.save();
}
æ·»åŠ æ–°è¯¾ç¨‹
typescript
Copy code
async addCourse(createCourseDto: CreateCourseDto): Promise<Course> {
    const createdCourse = new this.courseModel(createCourseDto);
    return await createdCourse.save();
}
å­¦ç”Ÿé€‰è¯¾
typescript
Copy code
async enrollStudent(studentId: string, courseId: string): Promise<Enrollment> {
    const enrollment = new this.enrollmentModel({ student: studentId, course: courseId });
    return await enrollment.save();
}
æŸ¥è¯¢æ•°æ®ï¼ˆæŸ¥ï¼‰
æŸ¥æ‰¾æ‰€æœ‰å­¦ç”Ÿ
typescript
Copy code
async findAllStudents(): Promise<Student[]> {
    return await this.studentModel.find().exec();
}
æŸ¥æ‰¾ç‰¹å®šå­¦ç”Ÿçš„æ‰€æœ‰è¯¾ç¨‹
typescript
Copy code
async findCoursesByStudent(studentId: string): Promise<Course[]> {
    const enrollments = await this.enrollmentModel.find({ student: studentId }).populate('course').exec();
    return enrollments.map(enrollment => enrollment.course);
}
åˆ†é¡µæŸ¥è¯¢è¯¾ç¨‹
typescript
Copy code
async findCoursesWithPagination(page: number, limit: number): Promise<Course[]> {
    return await this.courseModel.find().skip(page * limit).limit(limit).exec();
}
å¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢å­¦ç”Ÿ
typescript
Copy code
async findStudentsWithConditions(page: number, limit: number, searchQuery: string): Promise<Student[]> {
    const regexQuery = new RegExp(searchQuery, 'i');
    return await this.studentModel.find({ name: regexQuery }).skip(page * limit).limit(limit).exec();
}
æ›´æ–°æ•°æ®ï¼ˆæ”¹ï¼‰
æ›´æ–°å­¦ç”Ÿä¿¡æ¯
typescript
Copy code
async updateStudent(studentId: string, updateStudentDto: UpdateStudentDto): Promise<Student> {
    return await this.studentModel.findByIdAndUpdate(studentId, updateStudentDto, { new: true }).exec();
}
æ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
async updateMultipleCourses(titleRegex: string, updateCourseDto: UpdateCourseDto): Promise<void> {
    await this.courseModel.updateMany({ title: new RegExp(titleRegex, 'i') }, updateCourseDto).exec();
}
åˆ é™¤æ•°æ®ï¼ˆåˆ ï¼‰
åˆ é™¤å­¦ç”ŸåŠå…¶é€‰è¯¾ä¿¡æ¯
typescript
Copy code
async removeStudent(studentId: string): Promise<void> {
    await this.enrollmentModel.deleteMany({ student: studentId }).exec();
    await this.studentModel.findByIdAndRemove(studentId).exec();
}
åˆ é™¤è¯¾ç¨‹åŠå…¶é€‰è¯¾ä¿¡æ¯
typescript
Copy code
async removeCourse(courseId: string): Promise<void> {
    await this.enrollmentModel.deleteMany({ course: courseId }).exec();
    await this.courseModel.findByIdAndRemove(courseId).exec();
}
é”™è¯¯å¤„ç†å’ŒéªŒè¯
åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ¯ä¸ªæ“ä½œéƒ½åº”åŒ…æ‹¬é”™è¯¯å¤„ç†å’Œæ•°æ®éªŒè¯ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½éœ€è¦ç¡®è®¤å­¦ç”Ÿæˆ–è¯¾ç¨‹çš„IDç¡®å®å­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œç„¶åå†æ‰§è¡Œæ·»åŠ ã€æ›´æ–°æˆ–åˆ é™¤æ“ä½œã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥æ·»åŠ æ—¥å¿—è®°å½•ã€äº‹åŠ¡ç®¡ç†ï¼ˆå¦‚æœMongoDBç‰ˆæœ¬æ”¯æŒï¼‰å’Œå…¶ä»–é«˜çº§åŠŸèƒ½ï¼Œä»¥æ»¡è¶³æ›´å¤æ‚çš„ä¸šåŠ¡éœ€æ±‚ã€‚

è¿™ä¸ªç¤ºä¾‹ä¸ºå¦‚ä½•åœ¨Nest.jsä¸­å¤„ç†è¾ƒå¤æ‚çš„å¤šå¯¹å¤šå…³ç³»æä¾›äº†ä¸€ä¸ªæ¡†æ¶ã€‚åœ¨çœŸå®çš„åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½è¿˜éœ€è¦è€ƒè™‘æ›´å¤šçš„ä¸šåŠ¡é€»è¾‘å’Œè¾¹ç¼˜æƒ…å†µã€‚
==================================================================================================

User
å­¦ç”Ÿå’Œè¯¾ç¨‹é‡‡ç”¨åŒå‘å¼•ç”¨çš„ç®¡ç†æ–¹å¼ï¼Œå¤šå¯¹å¤šä¹‹é—´çš„å¢æŸ¥åˆ æ”¹ï¼Œå¤šè¡¨è”æŸ¥ï¼Œåˆ†é¡µæŸ¥è¯¢ï¼Œå¸¦æ¡ä»¶åˆ†é¡µæŸ¥è¯¢éƒ½åº”è¯¥æ€ä¹ˆå†™ï¼Œè¯·å…·ä½“ä¸¾ä¾‹å†™å‡ºï¼Œå†™çš„è¯¦ç»†ä¸€ç‚¹ï¼Œä¸šåŠ¡ä»£ç å°½å¯èƒ½å¤æ‚ä¸€ç‚¹ï¼Œæ¨¡ä»¿çœŸå®å¼€å‘åœºæ™¯çš„ä»£ç 
GPT
åœ¨ä¸€ä¸ªçœŸå®çš„å¼€å‘åœºæ™¯ä¸­ï¼Œä½¿ç”¨åŒå‘å¼•ç”¨æ¥ç®¡ç†å­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»æ¶‰åŠåˆ°ä¸€ç³»åˆ—çš„æ“ä½œï¼ŒåŒ…æ‹¬å¢åŠ ã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤æ•°æ®ï¼Œä»¥åŠå¤šè¡¨è”æŸ¥ã€åˆ†é¡µæŸ¥è¯¢å’Œå¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•åœ¨Nest.jsä¸­ä½¿ç”¨Mongooseæ¥å®ç°è¿™äº›æ“ä½œã€‚

æ•°æ®æ¨¡å‹
æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸¤ä¸ªæ¨¡å‹ï¼šStudent å’Œ Courseã€‚åœ¨è¿™ä¸¤ä¸ªæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ†åˆ«å¼•ç”¨å¯¹æ–¹çš„IDæ¥åˆ›å»ºåŒå‘å…³ç³»ã€‚

Student Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const StudentSchema = new mongoose.Schema({
    name: { type: String, required: true },
    email: { type: String, required: true, unique: true },
    courses: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Course' }],
    // å…¶ä»–å­—æ®µ
});
Course Model
typescript
Copy code
import * as mongoose from 'mongoose';

export const CourseSchema = new mongoose.Schema({
    title: { type: String, required: true },
    description: String,
    students: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Student' }],
    // å…¶ä»–å­—æ®µ
});
å¢åŠ æ•°æ®ï¼ˆå¢ï¼‰
æ·»åŠ æ–°å­¦ç”Ÿ
typescript
Copy code
async addStudent(createStudentDto: CreateStudentDto): Promise<Student> {
    const createdStudent = new this.studentModel(createStudentDto);
    return await createdStudent.save();
}
æ·»åŠ æ–°è¯¾ç¨‹
typescript
Copy code
async addCourse(createCourseDto: CreateCourseDto): Promise<Course> {
    const createdCourse = new this.courseModel(createCourseDto);
    return await createdCourse.save();
}
å­¦ç”Ÿé€‰è¯¾
typescript
Copy code
async enrollStudentInCourse(studentId: string, courseId: string): Promise<void> {
    await this.studentModel.findByIdAndUpdate(studentId, { $addToSet: { courses: courseId } }).exec();
    await this.courseModel.findByIdAndUpdate(courseId, { $addToSet: { students: studentId } }).exec();
}
æŸ¥è¯¢æ•°æ®ï¼ˆæŸ¥ï¼‰
æŸ¥æ‰¾æ‰€æœ‰å­¦ç”ŸåŠå…¶è¯¾ç¨‹
typescript
Copy code
async findAllStudentsWithCourses(): Promise<Student[]> {
    return await this.studentModel.find().populate('courses').exec();
}
åˆ†é¡µæŸ¥è¯¢è¯¾ç¨‹åŠé€‰è¯¾å­¦ç”Ÿ
typescript
Copy code
async findCoursesWithStudents(page: number, limit: number): Promise<Course[]> {
    return await this.courseModel.find().populate('students').skip(page * limit).limit(limit).exec();
}
å¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢å­¦ç”Ÿ
typescript
Copy code
async findStudentsWithConditions(page: number, limit: number, searchQuery: string): Promise<Student[]> {
    const regexQuery = new RegExp(searchQuery, 'i');
    return await this.studentModel.find({ name: regexQuery }).populate('courses').skip(page * limit).limit(limit).exec();
}
æ›´æ–°æ•°æ®ï¼ˆæ”¹ï¼‰
æ›´æ–°å­¦ç”Ÿä¿¡æ¯
typescript
Copy code
async updateStudent(studentId: string, updateStudentDto: UpdateStudentDto): Promise<Student> {
    return await this.studentModel.findByIdAndUpdate(studentId, updateStudentDto, { new: true }).populate('courses').exec();
}
æ›´æ–°å¤šæ¡åŒ¹é…æ¡ä»¶çš„è¯¾ç¨‹
typescript
Copy code
async updateMultipleCourses(titleRegex: string, updateCourseDto: UpdateCourseDto): Promise<void> {
    await this.courseModel.updateMany({ title: new RegExp(titleRegex, 'i') }, updateCourseDto).exec();
}
åˆ é™¤æ•°æ®ï¼ˆåˆ ï¼‰
åˆ é™¤å­¦ç”ŸåŠå…¶é€‰è¯¾ä¿¡æ¯
typescript
Copy code
async removeStudent(studentId: string): Promise<void> {
    await this.courseModel.updateMany({}, { $pull: { students: studentId } }).exec();
    await this.studentModel.findByIdAndRemove(studentId).exec();
}
åˆ é™¤è¯¾ç¨‹åŠå…¶é€‰è¯¾å­¦ç”Ÿ
typescript
Copy code
async removeCourse(courseId: string): Promise<void> {
    await this.studentModel.updateMany({}, { $pull: { courses: courseId } }).exec();
    await this.courseModel.findByIdAndRemove(courseId).exec();
}
é”™è¯¯å¤„ç†å’ŒéªŒè¯
åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ¯ä¸ªæ“ä½œéƒ½åº”åŒ…æ‹¬é”™è¯¯å¤„ç†å’Œæ•°æ®éªŒè¯ã€‚ä¾‹å¦‚ï¼ŒéªŒè¯å­¦ç”Ÿæˆ–è¯¾ç¨‹çš„IDæ˜¯å¦å­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œç„¶åå†æ‰§è¡Œæ·»åŠ ã€æ›´æ–°æˆ–åˆ é™¤æ“ä½œã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥æ·»åŠ æ—¥å¿—è®°å½•ã€äº‹åŠ¡ç®¡ç†ï¼ˆå¦‚æœMongoDBç‰ˆæœ¬æ”¯æŒï¼‰ç­‰ã€‚

è¿™ä¸ªç¤ºä¾‹æä¾›äº†ä¸€ä¸ªå…³äºå¦‚ä½•åœ¨Nest.jsä¸­å¤„ç†å­¦ç”Ÿå’Œè¯¾ç¨‹å¤šå¯¹å¤šå…³ç³»çš„æ¡†æ¶ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½è¿˜éœ€è¦è€ƒè™‘æ›´å¤šçš„ä¸šåŠ¡é€»è¾‘å’Œè¾¹ç¼˜æƒ…å†µã€‚


============================================================================
    User
mongodbä¸¤è¡¨æœ‰å¤šå¯¹å¤šå…³ç³»æ—¶ï¼Œå¯ä»¥é‡‡ç”¨åŒå‘å¼•ç”¨å’Œå…³è”é›†åˆçš„æ–¹å¼ï¼Œå“ªç§æ˜¯å¼€å‘ä¸­æ›´å¸¸ç”¨æ›´å¥½çš„æ–¹å¼ï¼Ÿ
GPT
åœ¨MongoDBä¸­å¤„ç†å¤šå¯¹å¤šå…³ç³»æ—¶ï¼Œé€‰æ‹©åŒå‘å¼•ç”¨è¿˜æ˜¯å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰ä¸»è¦å–å†³äºä½ çš„å…·ä½“åº”ç”¨åœºæ™¯å’Œéœ€æ±‚ã€‚ä¸‹é¢æ˜¯è¿™ä¸¤ç§æ–¹æ³•çš„ä¼˜ç¼ºç‚¹ï¼Œä»¥åŠåœ¨å®é™…å¼€å‘ä¸­å®ƒä»¬é€šå¸¸çš„é€‚ç”¨æƒ…å†µï¼š

åŒå‘å¼•ç”¨
ä¼˜ç‚¹ï¼š

ç®€å•ç›´æ¥ï¼šæ¯ä¸ªæ–‡æ¡£ç›´æ¥å­˜å‚¨ä¸ä¹‹ç›¸å…³çš„å…¶ä»–æ–‡æ¡£çš„IDï¼Œæ˜“äºç†è§£å’Œå®ç°ã€‚
æŸ¥è¯¢æ•ˆç‡ï¼šå¦‚æœä½ éœ€è¦ç»å¸¸å¿«é€Ÿè®¿é—®å…³è”æ•°æ®ï¼ŒåŒå‘å¼•ç”¨å¯ä»¥ä½¿å¾—æŸ¥è¯¢æ›´åŠ ç›´æ¥ã€‚
ç¼ºç‚¹ï¼š

æ•°æ®å†—ä½™ï¼šåŒä¸€ä¸ªå…³ç³»åœ¨ä¸¤ä¸ªæ–‡æ¡£ä¸­éƒ½éœ€è¦ç»´æŠ¤ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®å†—ä½™ã€‚
æ›´æ–°å¼€é”€ï¼šå½“å…³ç³»å˜æ›´æ—¶ï¼Œå¯èƒ½éœ€è¦åœ¨ä¸¤ä¸ªåœ°æ–¹è¿›è¡Œæ›´æ–°ï¼Œå¢åŠ äº†ç»´æŠ¤æˆæœ¬ã€‚
æ‰©å±•æ€§é™åˆ¶ï¼šå¦‚æœå…³ç³»éå¸¸å¤æ‚æˆ–è€…æ•°é‡éå¸¸åºå¤§ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½ä¼šå˜å¾—ä¸å®ç”¨ã€‚
é€‚ç”¨åœºæ™¯ï¼š

å…³ç³»æ•°é‡ç›¸å¯¹å›ºå®šï¼Œä¸ç»å¸¸å˜æ›´ã€‚
éœ€è¦å¿«é€Ÿè®¿é—®å…³è”æ•°æ®ã€‚
æ•°æ®é‡ä¸æ˜¯ç‰¹åˆ«å¤§ã€‚
å…³è”é›†åˆï¼ˆä¸­é—´é›†åˆï¼‰
ä¼˜ç‚¹ï¼š

çµæ´»æ€§ï¼šæä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨å…³ç³»å¤æ‚æˆ–è€…ç»å¸¸å˜åŠ¨çš„æƒ…å†µä¸‹ã€‚
é¿å…æ•°æ®å†—ä½™ï¼šå…³ç³»æ•°æ®é›†ä¸­å­˜å‚¨åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œé¿å…äº†å†—ä½™ã€‚
æ‰©å±•æ€§ï¼šæ›´é€‚åˆå¤„ç†å¤§é‡çš„å…³ç³»å’Œå¤æ‚çš„å…³ç³»ç½‘ç»œã€‚
ç¼ºç‚¹ï¼š

æŸ¥è¯¢å¤æ‚åº¦ï¼šéœ€è¦è¿›è¡Œé¢å¤–çš„æŸ¥è¯¢æ¥è·å–å®Œæ•´çš„å…³ç³»æ•°æ®ã€‚
æ€§èƒ½è€ƒè™‘ï¼šåœ¨æœ‰å¤§é‡å…³è”æ•°æ®æ—¶ï¼ŒæŸ¥è¯¢å¯èƒ½ä¼šå˜å¾—æ›´åŠ å¤æ‚å’Œè€—æ—¶ã€‚
é€‚ç”¨åœºæ™¯ï¼š

å…³ç³»ç»å¸¸å˜æ›´ã€‚
å…³ç³»éå¸¸å¤æ‚æˆ–æ¶‰åŠå¤§é‡æ•°æ®ã€‚
å½“å…³ç³»æœ¬èº«éœ€è¦å­˜å‚¨é¢å¤–ä¿¡æ¯æ—¶ï¼ˆä¾‹å¦‚ï¼Œåœ¨ç”¨æˆ·å’Œç¾¤ç»„çš„å…³ç³»ä¸­å­˜å‚¨ç”¨æˆ·è§’è‰²ï¼‰ã€‚
æ€»ç»“
æ²¡æœ‰ç»å¯¹çš„â€œæ›´å¥½â€æ–¹æ³•ï¼Œé€‰æ‹©å“ªç§æ–¹å¼å®Œå…¨å–å†³äºä½ çš„åº”ç”¨éœ€æ±‚ã€‚å¦‚æœä½ çš„åº”ç”¨ä¸­å…³ç³»æ¯”è¾ƒç®€å•ï¼Œä¸”æŸ¥è¯¢æ•ˆç‡æ˜¯å…³é”®è€ƒè™‘å› ç´ ï¼ŒåŒå‘å¼•ç”¨å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚è€Œå¦‚æœä½ çš„åº”ç”¨éœ€è¦å¤„ç†å¤§é‡ã€å¤æ‚çš„å…³ç³»ï¼Œæˆ–è€…å…³ç³»æ•°æ®æœ¬èº«å°±éœ€è¦å­˜å‚¨é¢å¤–çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆä½¿ç”¨å…³è”é›†åˆå¯èƒ½æ›´ä¸ºåˆé€‚ã€‚

åœ¨å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®å…ˆåˆ†æä½ çš„æ•°æ®å’Œä¸šåŠ¡éœ€æ±‚ï¼Œç„¶åé€‰æ‹©æœ€é€‚åˆä½ æƒ…å†µçš„æ–¹æ³•ã€‚æœ‰æ—¶å€™ï¼Œç”šè‡³å¯ä»¥æ ¹æ®ä¸åŒçš„éœ€æ±‚ï¼Œåœ¨åŒä¸€åº”ç”¨ä¸­æ··åˆä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ ğŸŒŸ



